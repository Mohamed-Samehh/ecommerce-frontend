@if (book()) {
  <a class="text-decoration-none h-100 d-block wyrm-card-link">
    <div class="card wyrm-card h-100 d-flex flex-column border-0">
      <div class="position-relative overflow-hidden wyrm-image-wrapper">
        <img [src]="book()?.coverImage" class="wyrm-card-img" alt="book image" />

        <div
          class="position-absolute top-0 end-0 mt-3 me-3 badge wyrm-price-badge rounded-pill shadow-sm"
        >
          <span>${{ book()?.price }}</span>
        </div>
      </div>

      <div class="card-body d-flex flex-column px-4 py-4 wyrm-card-body">
        <div class="mb-2">
          <h6 class="wyrm-card-author text-truncate mb-1">{{ book()?.author }}</h6>
          <h5 class="wyrm-card-title text-truncate-2" [title]="book()?.name">{{ book()?.name }}</h5>
        </div>

        <div class="d-flex align-items-center justify-content-between mb-3 pb-3 wyrm-card-divider">
          <div class="d-flex align-items-center">
            <app-star-rating
              [value]="book()?.averageRating ?? 0"
              [readonly]="true"
            ></app-star-rating>
            <span class="ms-2 wyrm-rating-text"
              >({{ book()?.averageRating | number: '1.1-1' }})</span
            >
          </div>

          <div class="wyrm-stock-indicator">
            @if ((book()?.stock ?? 0) > 2) {
              <span class="status-available"><span class="stock-dot"></span> Available</span>
            } @else if ((book()?.stock ?? 0) > 0) {
              <span class="status-low"><span class="stock-dot"></span> Low Stock</span>
            } @else {
              <span class="status-out"><span class="stock-dot"></span> Out of Print</span>
            }
          </div>
        </div>

        <p class="wyrm-card-desc text-truncate-2 mb-4">{{ book()?.description }}</p>

        <div class="mt-auto">
          <button
            class="btn wyrm-card-btn-solid w-100"
            (click)="addToCart($event)"
            [disabled]="isAdding() || (book()?.stock ?? 0) <= 0"
          >
            @if (isAdding()) {
              <i class="fa-solid fa-spinner fa-spin me-2"></i> Securing...
            } @else if ((book()?.stock ?? 0) <= 0) {
              <i class="fa-solid fa-lock me-2"></i> Unavailable
            } @else {
              <i class="fa-solid fa-cart-plus me-2"></i> Add to Cart
            }
          </button>
        </div>
      </div>
    </div>
  </a>
}
